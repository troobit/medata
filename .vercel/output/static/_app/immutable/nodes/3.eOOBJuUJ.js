import{b as Q,a as i,f as p,c as z}from"../chunks/kKy66PDH.js";import{o as xe}from"../chunks/Dq_pO5zq.js";import{t as x,p as we,a as ke,s as u,c as l,r as s,k as Te,h as Le,g as a,f as C,u as k,au as Me}from"../chunks/DTv0fGkk.js";import{s as b}from"../chunks/9Aoxbd_n.js";import{i as d}from"../chunks/CLGhL_wd.js";import{e as V}from"../chunks/e5qBh1E7.js";import{d as Se}from"../chunks/CEtxWd_S.js";import{s as H,c as je}from"../chunks/D-fc9hNp.js";import{L as Ie}from"../chunks/X_0Vvn7d.js";import{E as $e}from"../chunks/l9QAdfOH.js";import"../chunks/NoJzPs2l.js";import{I as Ue,M as Be,B as Ee}from"../chunks/D3tohD0M.js";import{p as Ae}from"../chunks/CRGBfSix.js";import{e as T}from"../chunks/Dvvmo4p2.js";var De=Q('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 3h8l-1 8a4 4 0 01-3 3.87V18"></path><path stroke-linecap="round" stroke-width="1.5" d="M9 7h6"></path><path stroke-linecap="round" stroke-width="2" d="M12 15v3"></path><path stroke-linecap="round" stroke-width="2" d="M8 21h8"></path></svg>');function Ne(L,M){let c=Ae(M,"class",3,"h-6 w-6");var h=De();x(()=>H(h,0,je(c()))),i(L,h)}var ze=p('<button type="button"> </button>'),Ce=p('<div class="flex justify-center py-12"><!></div>'),Ve=Q('<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>'),He=p('<span class="flex h-8 w-8 items-center justify-center rounded-full bg-amber-500/20 text-amber-400"><!></span>'),Oe=p('<span class="ml-2 text-gray-400"> </span>'),Re=p('<li class="flex items-center justify-between rounded-lg bg-gray-800/50 px-4 py-3"><div class="flex items-center gap-3"><div class="flex items-center gap-1"><span><!></span> <!></div> <div><p class="font-medium text-gray-200"> </p> <p class="text-sm text-gray-500"> <!></p></div></div></li>'),qe=p('<div><h2 class="mb-3 text-sm font-medium text-gray-400"> </h2> <ul class="space-y-2"></ul></div>'),Fe=p('<div class="space-y-6"></div>'),Ge=p('<div class="px-4 py-6"><header class="mb-6"><h1 class="text-2xl font-bold text-white">History</h1></header> <div class="mb-6 flex gap-2 overflow-x-auto pb-2"></div> <!></div>');function la(L,M){we(M,!0);let c=Le("all");xe(()=>{T.loadRecent(50)});const h=k(()=>a(c)==="all"?T.events:T.events.filter(e=>e.eventType===a(c))),W=k(()=>{const e={};for(const t of a(h)){const r=new Date(t.timestamp).toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric"});e[r]||(e[r]=[]),e[r].push(t)}return Object.entries(e)});function X(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function Y(e){switch(e.eventType){case"insulin":return`${e.value} units ${e.metadata.type||""}`;case"meal":{const t=e.metadata,r=[];return e.value>0&&r.push(`${e.value}g carbs`),t.alcoholUnits&&t.alcoholUnits>0&&r.push(`${t.alcoholUnits} ${t.alcoholUnits===1?"drink":"drinks"}`),r.length>0?r.join(", "):"Logged"}case"bsl":return`${e.value} ${e.metadata.unit||"mmol/L"}`;case"exercise":return`${e.value} min`;default:return String(e.value)}}function Z(e){return e.eventType!=="meal"?!1:(e.metadata.alcoholUnits??0)>0}var S=Ge(),j=u(l(S),2);V(j,20,()=>[{value:"all",label:"All"},{value:"insulin",label:"Insulin"},{value:"meal",label:"Meals"},{value:"bsl",label:"BSL"}],e=>e.value,(e,t)=>{var r=ze();r.__click=()=>Te(c,t.value,!0);var I=l(r,!0);s(r),x(()=>{H(r,1,`whitespace-nowrap rounded-full px-4 py-2 text-sm font-medium transition-colors ${a(c)===t.value?"bg-brand-accent text-gray-950":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`),b(I,t.label)}),i(e,r)}),s(j);var ee=u(j,2);{var ae=e=>{var t=Ce(),r=l(t);Ie(r,{size:"lg"}),s(t),i(e,t)},te=e=>{var t=z(),r=C(t);{var I=m=>{{let _=k(()=>a(c)==="all"?"Start tracking by logging your first entry.":`No ${a(c)} entries found.`);$e(m,{title:"No entries found",get description(){return a(_)}})}},re=m=>{var _=Fe();V(_,21,()=>a(W),([$,O])=>$,($,O)=>{var R=k(()=>Me(a(O),2));let se=()=>a(R)[0],oe=()=>a(R)[1];var U=qe(),B=l(U),le=l(B,!0);s(B);var q=u(B,2);V(q,21,oe,E=>E.id,(E,n)=>{var A=Re(),F=l(A),D=l(F),w=l(D),ie=l(w);{var ne=o=>{Ue(o,{class:"h-5 w-5"})},ve=o=>{var v=z(),y=C(v);{var fe=f=>{Be(f,{class:"h-5 w-5"})},ge=f=>{var P=z(),he=C(P);{var _e=g=>{Ee(g,{class:"h-5 w-5"})},ye=g=>{var be=Ve();i(g,be)};d(he,g=>{a(n).eventType==="bsl"?g(_e):g(ye,!1)},!0)}i(f,P)};d(y,f=>{a(n).eventType==="meal"?f(fe):f(ge,!1)},!0)}i(o,v)};d(ie,o=>{a(n).eventType==="insulin"?o(ne):o(ve,!1)})}s(w);var ce=u(w,2);{var pe=o=>{var v=He(),y=l(v);Ne(y,{class:"h-4 w-4"}),s(v),i(o,v)};d(ce,o=>{Z(a(n))&&o(pe)})}s(D);var G=u(D,2),N=l(G),ue=l(N,!0);s(N);var J=u(N,2),K=l(J),de=u(K);{var me=o=>{var v=Oe(),y=l(v);s(v),x(()=>b(y,`- ${a(n).metadata.description??""}`)),i(o,v)};d(de,o=>{a(n).eventType==="meal"&&a(n).metadata.description&&o(me)})}s(J),s(G),s(F),s(A),x((o,v)=>{H(w,1,`flex h-10 w-10 items-center justify-center rounded-full ${a(n).eventType==="insulin"?"bg-blue-500/20 text-blue-400":a(n).eventType==="meal"?"bg-green-500/20 text-green-400":a(n).eventType==="bsl"?"bg-yellow-500/20 text-yellow-400":"bg-purple-500/20 text-purple-400"}`),b(ue,o),b(K,`${v??""} `)},[()=>Y(a(n)),()=>X(a(n).timestamp)]),i(E,A)}),s(q),s(U),x(()=>b(le,se())),i($,U)}),s(_),i(m,_)};d(r,m=>{a(h).length===0?m(I):m(re,!1)},!0)}i(e,t)};d(ee,e=>{T.loading?e(ae):e(te,!1)})}s(S),i(L,S),ke()}Se(["click"]);export{la as component};
