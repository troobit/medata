import{f as p,a as d,t as tt}from"../chunks/kKy66PDH.js";import{p as et,h as v,i as G,j as at,g as t,k as o,c as n,s as r,t as b,a as rt,u as st,r as s,n as H}from"../chunks/DTv0fGkk.js";import{s as m}from"../chunks/9Aoxbd_n.js";import{i as J}from"../chunks/CLGhL_wd.js";import{e as nt}from"../chunks/e5qBh1E7.js";import{r as it}from"../chunks/BjHF3nwv.js";import{s as T}from"../chunks/D-fc9hNp.js";import{d as lt}from"../chunks/CEtxWd_S.js";import{b as ot}from"../chunks/Do8t-uj2.js";import{g as ut}from"../chunks/Bm5o5tlR.js";import{B as ct}from"../chunks/NoJzPs2l.js";import{s as K,e as f}from"../chunks/Dvvmo4p2.js";var dt=p('<button type="button"> </button>'),bt=p('<div class="mb-8"><span id="recent-doses-label" class="mb-2 block text-sm font-medium text-gray-400"> </span> <div class="flex flex-wrap gap-2" role="group" aria-labelledby="recent-doses-label"></div></div>'),gt=p('<div class="mb-4 rounded-lg bg-red-500/20 px-4 py-3 text-red-400"> </div>'),vt=p('<div class="flex min-h-[calc(100dvh-80px)] flex-col px-4 py-6"><header class="mb-8"><a href="/log" class="mb-4 inline-flex items-center text-gray-400 hover:text-gray-200"><svg class="mr-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> Back</a> <h1 class="text-2xl font-bold text-white">Log Insulin</h1></header> <div class="flex flex-1 flex-col"><div class="mb-8"><span id="insulin-type-label" class="mb-2 block text-sm font-medium text-gray-400">Type</span> <div class="grid grid-cols-2 gap-2" role="group" aria-labelledby="insulin-type-label"><button type="button">Bolus</button> <button type="button">Basal</button></div></div> <div class="mb-8 flex-1"><label for="units-input" class="mb-2 block text-sm font-medium text-gray-400">Units</label> <div class="flex items-center justify-center gap-3"><button type="button" class="flex h-12 w-12 items-center justify-center rounded-full bg-gray-800 text-lg font-medium text-gray-300 transition-colors hover:bg-gray-700 active:bg-gray-600" aria-label="Decrease by 5 units">-5</button> <button type="button" class="flex h-14 w-14 items-center justify-center rounded-full bg-gray-800 text-2xl text-gray-300 transition-colors hover:bg-gray-700 active:bg-gray-600" aria-label="Decrease by 1 unit">-</button> <div class="w-24 text-center"><input id="units-input" type="number" min="0" max="300" aria-label="Insulin units" class="w-full bg-transparent text-center text-5xl font-bold text-white focus:outline-none"/> <span class="text-sm text-gray-400">units</span></div> <button type="button" class="flex h-14 w-14 items-center justify-center rounded-full bg-gray-800 text-2xl text-gray-300 transition-colors hover:bg-gray-700 active:bg-gray-600" aria-label="Increase by 1 unit">+</button> <button type="button" class="flex h-12 w-12 items-center justify-center rounded-full bg-gray-800 text-lg font-medium text-gray-300 transition-colors hover:bg-gray-700 active:bg-gray-600" aria-label="Increase by 5 units">+5</button></div></div> <!> <!> <!></div></div>');function Bt(N,O){et(O,!0);let a=v(0),i=v(G(K.settings.defaultInsulinType)),x=v(!1),y=v(G([]));at(()=>{Q(t(i))});async function Q(e){o(y,await f.getRecentInsulinDoses(e,4),!0)}function R(e=1){o(a,Math.min(300,Math.max(0,t(a)+e)),!0)}function L(e=1){o(a,Math.max(0,t(a)-e),!0)}async function V(){if(!(t(a)<=0)){o(x,!0);try{await f.logInsulin(t(a),t(i)),await K.update({defaultInsulinType:t(i)}),ut("/")}catch{}finally{o(x,!1)}}}var _=vt(),S=r(n(_),2),h=n(S),z=r(n(h),2),k=n(z);k.__click=()=>o(i,"bolus");var C=r(k,2);C.__click=()=>o(i,"basal"),s(z),s(h);var w=r(h,2),P=r(n(w),2),$=n(P);$.__click=()=>L(5);var I=r($,2);I.__click=()=>L(1);var j=r(I,2),U=n(j);it(U),H(2),s(j);var B=r(j,2);B.__click=()=>R(1);var q=r(B,2);q.__click=()=>R(5),s(P),s(w);var A=r(w,2);{var W=e=>{var l=bt(),u=n(l),g=n(u);s(u);var F=r(u,2);nt(F,20,()=>t(y),D=>D,(D,M)=>{var c=dt();c.__click=()=>o(a,M,!0);var Z=n(c,!0);s(c),b(()=>{T(c,1,`rounded-full px-4 py-2 text-sm font-medium transition-colors ${t(a)===M?"bg-blue-500 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`),m(Z,M)}),d(D,c)}),s(F),s(l),b(()=>m(g,`Recent ${t(i)??""} doses`)),d(e,l)};J(A,e=>{t(y).length>0&&e(W)})}var E=r(A,2);{var X=e=>{var l=gt(),u=n(l,!0);s(l),b(()=>m(u,f.error)),d(e,l)};J(E,e=>{f.error&&e(X)})}var Y=r(E,2);{let e=st(()=>t(a)<=0);ct(Y,{variant:"primary",size:"lg",class:"w-full",onclick:V,get disabled(){return t(e)},get loading(){return t(x)},children:(l,u)=>{H();var g=tt();b(()=>m(g,`Log ${t(a)??""} units ${t(i)??""}`)),d(l,g)},$$slots:{default:!0}})}s(S),s(_),b(()=>{T(k,1,`rounded-lg px-4 py-3 text-center font-medium transition-colors ${t(i)==="bolus"?"bg-blue-500 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`),T(C,1,`rounded-lg px-4 py-3 text-center font-medium transition-colors ${t(i)==="basal"?"bg-blue-500 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"}`),$.disabled=t(a)<5,I.disabled=t(a)<=0,B.disabled=t(a)>=300,q.disabled=t(a)>295}),ot(U,()=>t(a),e=>o(a,e)),d(N,_),rt()}lt(["click"]);export{Bt as component};
